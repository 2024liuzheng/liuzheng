<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>åœ¨çº¿è´­ç‰©æŠ˜æ‰£ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft Yahei", sans-serif;
        }
        body {
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .clock {
            font-size: 18px;
            color: #333;
            margin-bottom: 20px;
            padding: 10px;
            background: #e8f4f8;
            border-radius: 4px;
        }
        .form-section {
            margin-bottom: 30px;
        }
        form label {
            display: inline-block;
            width: 120px;
            margin: 10px 0;
        }
        form input, form select {
            padding: 8px;
            width: 200px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background: #0056b3;
        }
        .tips {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-left: 4px solid #007bff;
        }
        .dashboard {
            margin-top: 30px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        table th, table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        table th {
            background: #e9ecef;
        }
        .discount-tip {
            margin: 10px 0;
            padding: 10px;
            background: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="clock" id="clock"></div>
        
        <div class="form-section">
            <h3>è®¢å•å½•å…¥</h3>
            <form id="orderForm">
                <div>
                    <label for="customerName">å®¢æˆ·åç§°ï¼š</label>
                    <input type="text" id="customerName" placeholder="è¯·è¾“å…¥å®¢æˆ·åç§°">
                </div>
                <div>
                    <label for="price">å•†å“å•ä»·ï¼š</label>
                    <input type="number" id="price" placeholder="è¯·è¾“å…¥å¤§äº0çš„æ•°å­—" step="0.01">
                </div>
                <div>
                    <label for="quantity">è´­ä¹°æ•°é‡ï¼š</label>
                    <input type="number" id="quantity" placeholder="è¯·è¾“å…¥å¤§äº0çš„æ•´æ•°" step="1">
                </div>
                <div>
                    <label for="isVip">å®¢æˆ·ç±»å‹ï¼š</label>
                    <select id="isVip">
                        <option value="false">æ™®é€šå®¢æˆ·</option>
                        <option value="true">VIPå®¢æˆ·</option>
                    </select>
                </div>
                <div>
                    <label for="isUrgent">æ˜¯å¦åŠ æ€¥ï¼š</label>
                    <select id="isUrgent">
                        <option value="false">å¦</option>
                        <option value="true">æ˜¯</option>
                    </select>
                </div>
                <button type="button" onclick="addOrder()">æ·»åŠ è®¢å•</button>
            </form>
        </div>
        
        <div class="tips" id="tips"></div>
        
        <div class="dashboard">
            <h3>æˆäº¤å†å²</h3>
            <div id="dashboard"></div>
        </div>
    </div>

    <script>
        let orderHistory = [];
        let hitTimeDiscount = false;

        document.write(`
            <div class="discount-tip">
                <strong>è´­ç‰©æŠ˜æ‰£è§„åˆ™æé†’ï¼š</strong><br>
                1. VIPå®¢æˆ·äº«è®¢å•é‡‘é¢9æŠ˜ä¼˜æƒ ï¼›<br>
                2. åŠ æ€¥è®¢å•éœ€é¢å¤–æ”¯ä»˜1æˆåŠ æ€¥è´¹ï¼›<br>
                3. æ¯å°æ—¶å‰10åˆ†é’Ÿä¸‹å•äº«85æŠ˜ï¼›<br>
                4. æ›´å¤šæŠ˜æ‰£è§„åˆ™è¯·å‚è€ƒé¡µé¢è¯´æ˜ã€‚
            </div>
        `);

        function updateClock() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const day = now.getDate();
            const hour = now.getHours().toString().padStart(2, '0');
            const minute = now.getMinutes().toString().padStart(2, '0');
            const second = now.getSeconds().toString().padStart(2, '0');
            const weekArr = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
            const week = weekArr[now.getDay()];

            const minuteNum = now.getMinutes();
            hitTimeDiscount = minuteNum < 10;

            let clockText = `å½“å‰æ—¶é—´ï¼š${year}å¹´${month}æœˆ${day}æ—¥ ${hour}:${minute}:${second} ${week}`;
            if (hitTimeDiscount) {
                clockText += ' | ğŸŒŸ æ¯å°æ—¶å‰10åˆ†é’Ÿï¼Œäº«85æŠ˜ä¼˜æƒ ï¼';
            } else {
                clockText += ' | âš ï¸ å½“å‰æ— æ—¶é—´æŠ˜æ‰£ï¼Œä»…VIPäº«9æŠ˜ã€åŠ æ€¥éœ€åŠ 1æˆè´¹';
            }
            
            document.getElementById('clock').innerText = clockText;
        }

        updateClock();
        setInterval(updateClock, 1000);

        function checkForm(customerName, price, quantity) {
            if (!customerName || customerName.trim() === '') {
                alert('å®¢æˆ·åç§°ä¸èƒ½ä¸ºç©ºï¼');
                return false;
            }
            if (isNaN(price) || price <= 0) {
                alert('å•†å“å•ä»·å¿…é¡»æ˜¯å¤§äº0çš„æ•°å­—ï¼');
                return false;
            }
            if (isNaN(quantity) || quantity <= 0 || !Number.isInteger(Number(quantity))) {
                alert('è´­ä¹°æ•°é‡å¿…é¡»æ˜¯å¤§äº0çš„æ•´æ•°ï¼');
                return false;
            }
            return true;
        }

        function calculateTotal(price, quantity, isVip, isUrgent) {
            const baseTotal = price * quantity;
            let afterVip = isVip ? baseTotal * 0.9 : baseTotal;
            let afterUrgent = isUrgent ? afterVip * 1.1 : afterVip;
            
            let finalTotal = hitTimeDiscount ? afterUrgent * 0.85 : afterUrgent;

            return {
                baseTotal: baseTotal.toFixed(2),
                afterVip: afterVip.toFixed(2),
                afterUrgent: afterUrgent.toFixed(2),
                finalTotal: finalTotal.toFixed(2)
            };
        }

        function addOrder() {
            const customerName = document.getElementById('customerName').value;
            const price = parseFloat(document.getElementById('price').value);
            const quantity = parseInt(document.getElementById('quantity').value);
            const isVip = document.getElementById('isVip').value === 'true';
            const isUrgent = document.getElementById('isUrgent').value === 'true';

            if (!checkForm(customerName, price, quantity)) {
                return;
            }

            const totals = calculateTotal(price, quantity, isVip, isUrgent);

            let tipsHtml = `
                <p>å®¢æˆ·åç§°ï¼š${customerName}</p>
                <p>å•†å“å•ä»·ï¼šÂ¥${price.toFixed(2)}</p>
                <p>è´­ä¹°æ•°é‡ï¼š${quantity}ä»¶</p>
                <p>å®¢æˆ·ç±»å‹ï¼š${isVip ? 'VIPå®¢æˆ·' : 'æ™®é€šå®¢æˆ·'}</p>
                <p>æ˜¯å¦åŠ æ€¥ï¼š${isUrgent ? 'æ˜¯' : 'å¦'}</p>
                <p>åŸºç¡€æ€»ä»·ï¼šÂ¥${totals.baseTotal}</p>
                <p>VIPæŠ˜æ‰£åï¼šÂ¥${totals.afterVip}</p>
                <p>åŠ æ€¥è´¹åï¼šÂ¥${totals.afterUrgent}</p>
                <p>æ—¶é—´æŠ˜æ‰£${hitTimeDiscount ? 'ï¼ˆ85æŠ˜ï¼‰' : 'ï¼ˆæ— ï¼‰'}åæœ€ç»ˆæ€»ä»·ï¼šÂ¥${totals.finalTotal}</p>
            `;

            document.getElementById('tips').innerHTML = tipsHtml;

            const order = {
                customerName,
                price: price.toFixed(2),
                quantity,
                isVip: isVip ? 'VIP' : 'æ™®é€š',
                isUrgent: isUrgent ? 'æ˜¯' : 'å¦',
                baseTotal: totals.baseTotal,
                afterVip: totals.afterVip,
                afterUrgent: totals.afterUrgent,
                finalTotal: totals.finalTotal,
                createTime: new Date().toLocaleString()
            };
            orderHistory.push(order);

            renderDashboard();

            document.getElementById('orderForm').reset();
        }

        function renderDashboard() {
            if (orderHistory.length === 0) {
                document.getElementById('dashboard').innerHTML = '<p>æš‚æ— æˆäº¤è®°å½•</p>';
                return;
            }

            let tableHtml = `
                <table>
                    <tr>
                        <th>åºå·</th>
                        <th>å®¢æˆ·åç§°</th>
                        <th>å•†å“å•ä»·(Â¥)</th>
                        <th>è´­ä¹°æ•°é‡</th>
                        <th>å®¢æˆ·ç±»å‹</th>
                        <th>æ˜¯å¦åŠ æ€¥</th>
                        <th>åŸºç¡€æ€»ä»·(Â¥)</th>
                        <th>VIPæŠ˜æ‰£å(Â¥)</th>
                        <th>åŠ æ€¥è´¹å(Â¥)</th>
                        <th>æœ€ç»ˆæ€»ä»·(Â¥)</th>
                        <th>ä¸‹å•æ—¶é—´</th>
                    </tr>
            `;

            orderHistory.forEach((order, index) => {
                tableHtml += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${order.customerName}</td>
                        <td>${order.price}</td>
                        <td>${order.quantity}</td>
                        <td>${order.isVip}</td>
                        <td>${order.isUrgent}</td>
                        <td>${order.baseTotal}</td>
                        <td>${order.afterVip}</td>
                        <td>${order.afterUrgent}</td>
                        <td>${order.finalTotal}</td>
                        <td>${order.createTime}</td>
                    </tr>
                `;
            });

            tableHtml += '</table>';
            document.getElementById('dashboard').innerHTML = tableHtml;
        }

        renderDashboard();
    </script>
</body>
</html>